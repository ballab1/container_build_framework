#!/bin/bash

# copy runtime framework (only copy updates)
mkdir -p "${CBF['crt_base']}"
cd "${CBF['crf_base']}"
for file in $(find . -type f ! -name '.*'); do
    diff "$file" "${CBF['crt_base']}/$file"
    [ $? -ne 0 ] || continue
    cp "$file" "${CBF['crt_base']}/$file"
done

# create docker-entrypoint.sh from copy default entrypoint script if none exists
if [ ! -e "${CBF['base']}/usr/local/bin/docker-entrypoint.sh" ]; then
    mkdir -p /usr/local/bin
    sed "s/newcontainer/${CONTAINER_NAME}/gi" "${CBF['crf_bin']}/default.entrypoint" > /usr/local/bin/docker-entrypoint.sh
fi